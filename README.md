Spaghetti
=========

Spaghetti provides type-safe communication between JavaScript modules.

[![Build Status](https://travis-ci.org/prezi/spaghetti.svg)](https://travis-ci.org/prezi/spaghetti)
[![Analytics](https://ga-beacon.appspot.com/UA-54695510-1/github.com/prezi/spaghetti)](https://github.com/igrigorik/ga-beacon)

Modularizing a large, evolving JavaScript applications is hard, because the untyped nature of the modules makes it difficult to keep track of changing APIs. Spaghetti uses compilers to check communication between modules, transforming run-time API compatibility problems into compile errors.

## How Does it Work?

Spaghetti modules are written in compile-to-JS languages like [TypeScript](http://typescriptlang.org) and [Haxe](http://haxe.org). Each module's API is defined in a [Spaghetti Interface Definition file](/../../wiki/Spaghetti Syntax).

Based on this abstract API definition, Spaghetti ensures type safety on both sides of the communiaction:

* When implementing a module, its Spaghetti API gets transpiled into language specific source code. This code declares the API in language-specific terms (i.e. classes and interfaces). Your module's implementation must be compatible with these generated interfaces, and in turn with the Spaghetti API.
* Spaghetti generates language-specific proxy classes to access other modules in a type-safe way, based on those modules' Spaghetti APIs.

This approach also allows modules to be written using different languages (e.g. you can access modules written in TypeScript from a Haxe module etc.).

## Example

The definition of a Spaghetti module looks like this:

```
module com.example.test as TestModule

/**
 * A tool to greet guests.
 */
interface Greeter {

    /**
     * Greets a guest and returns the greeting.
     */
    string sayHello(string guest)
}

/**
 * Creates a Greeter.
 */
Greeter createGreeter()
```

From the definition Spaghetti generates the language-specific types for the language of your choice (as long as it is TypeScript or Haxe for now). Here's how it looks like in Haxe:

```haxe
/* Generated by Spaghetti */
package com.example.test;

interface Greeter {
    /**
     * Greets a guest and returns the greeting.
     */
    function sayHello(guest:String):String;
}
```

You then create classes that implement the generated interfaces. You also need to create a "module class" that implements the static, module-level methods (`createGreeter()` in this case) defined in the Spaghetti definitino. In Haxe you would write the following:

```haxe
package com.example.test;

class TestModule {
    public static function createGreeter():Greeter {
        return new DefaultGreeter();
    }
}

class DefaultGreeter implements Greeter {
    public function sayHello(guest:String):String {
        return 'Hello ${guest}!';
    }
}
```

Once you have your module compiled into a single JS file, Spaghetti will bundle it into a ZIP file together with the module's definition. It is also possible to include resources (images, CSS etc.) in a module bundle that are accessible to the module's code.

When someone wants to use your module, they need to provide Spaghetti with the bundle you've created. Spaghetti then generates proxy classes to call your module in a type-safe way. To continue with the example, you could call your Haxe module from TypeScript via the generated proxy like this:

```typescript
var greeter = com.example.test.TestModule.createGreeter();
console.log(greeter.sayHello("World"));
```

## Try It

Check [the tutorial here](/../../wiki/Tutorial) for a step-by-step introduction to Spaghetti.

There is a working example under [spaghetti-gradle-example](spaghetti-gradle-example). This one uses the Gradle build integration.

## How to Use It?

### Command-Line Tool

The quickest way to try Spaghetti is to use it via its [command-line tool](spaghetti).

### Gradle

Spaghetti comes with a Gradle plugin that makes it easy to integrate Spaghetti into your workflow when building larger applications.

Read more about in the [plugin's readme](gradle-spaghetti-plugin/README.md).

### Other Build Systems

Maven support is planned, but no clear deadline is decided right now.
